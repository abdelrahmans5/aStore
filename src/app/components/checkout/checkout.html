<div class="checkout-container">
    <div class="checkout-background">
        <div class="checkout-shapes">
            <div class="checkout-shape checkout-shape-1"></div>
            <div class="checkout-shape checkout-shape-2"></div>
            <div class="checkout-shape checkout-shape-3"></div>
        </div>
    </div>

    <div class="checkout-content">
        <div class="checkout-header">
            <div class="checkout-icon">
                <i class="fas fa-credit-card"></i>
            </div>
            <h1 class="checkout-title">Secure Checkout</h1>
            <div class="progress-bar">
                <div class="progress-step" [class.active]="currentStep >= 1" [class.completed]="currentStep > 1">
                    <span class="step-number">1</span>
                    <span class="step-label">Contact</span>
                </div>
                <div class="progress-line" [class.completed]="currentStep > 1"></div>
                <div class="progress-step" [class.active]="currentStep >= 2" [class.completed]="currentStep > 2">
                    <span class="step-number">2</span>
                    <span class="step-label">Shipping</span>
                </div>
                <div class="progress-line" [class.completed]="currentStep > 2"></div>
                <div class="progress-step" [class.active]="currentStep >= 3">
                    <span class="step-number">3</span>
                    <span class="step-label">Payment</span>
                </div>
            </div>
        </div>

        <div class="checkout-main">
            <div class="checkout-form">
                <!-- Step 1: Contact Information -->
                <div class="form-step" *ngIf="currentStep === 1">
                    <h2 class="step-title">Contact Information</h2>

                    <div class="form-group">
                        <label for="email">Email Address</label>
                        <input type="email" id="email" [(ngModel)]="formData.email" placeholder="your@email.com">
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="firstName">First Name</label>
                            <input type="text" id="firstName" [(ngModel)]="formData.firstName" placeholder="John">
                        </div>
                        <div class="form-group">
                            <label for="lastName">Last Name</label>
                            <input type="text" id="lastName" [(ngModel)]="formData.lastName" placeholder="Doe">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="phone">Phone Number</label>
                        <input type="tel" id="phone" [(ngModel)]="formData.phone" placeholder="+1 (555) 123-4567">
                    </div>

                    <div class="checkbox-group">
                        <input type="checkbox" id="newsletter" [(ngModel)]="formData.newsletter">
                        <label for="newsletter">Keep me updated with news and offers</label>
                    </div>
                </div>

                <!-- Step 2: Shipping Address -->
                <div class="form-step" *ngIf="currentStep === 2">
                    <h2 class="step-title">Shipping Address</h2>

                    <div class="form-group">
                        <label for="address">Street Address</label>
                        <input type="text" id="address" [(ngModel)]="formData.address" placeholder="123 Main Street">
                    </div>

                    <div class="form-group">
                        <label for="apartment">Apartment, suite, etc. (optional)</label>
                        <input type="text" id="apartment" [(ngModel)]="formData.apartment" placeholder="Apt 4B">
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="city">City</label>
                            <input type="text" id="city" [(ngModel)]="formData.city" placeholder="New York">
                        </div>
                        <div class="form-group">
                            <label for="state">State</label>
                            <select id="state" [(ngModel)]="formData.state">
                                <option value="">Select State</option>
                                <option value="CA">California</option>
                                <option value="NY">New York</option>
                                <option value="TX">Texas</option>
                                <option value="FL">Florida</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="zipCode">ZIP Code</label>
                            <input type="text" id="zipCode" [(ngModel)]="formData.zipCode" placeholder="10001">
                        </div>
                    </div>

                    <div class="checkbox-group">
                        <input type="checkbox" id="saveInfo" [(ngModel)]="formData.saveInfo">
                        <label for="saveInfo">Save this information for next time</label>
                    </div>
                </div>

                <!-- Step 3: Payment Information -->
                <div class="form-step" *ngIf="currentStep === 3">
                    <h2 class="step-title">Payment Information</h2>

                    <div class="payment-methods">
                        <div class="payment-method active">
                            <i class="fas fa-credit-card"></i>
                            <span>Credit Card</span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="cardNumber">Card Number</label>
                        <input type="text" id="cardNumber" [(ngModel)]="formData.cardNumber"
                            placeholder="1234 5678 9012 3456" maxlength="19">
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="expiryDate">Expiry Date</label>
                            <input type="text" id="expiryDate" [(ngModel)]="formData.expiryDate" placeholder="MM/YY"
                                maxlength="5">
                        </div>
                        <div class="form-group">
                            <label for="cvv">CVV</label>
                            <input type="text" id="cvv" [(ngModel)]="formData.cvv" placeholder="123" maxlength="3">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="cardName">Name on Card</label>
                        <input type="text" id="cardName" [(ngModel)]="formData.cardName" placeholder="John Doe">
                    </div>
                </div>

                <!-- Navigation Buttons -->
                <div class="form-navigation">
                    <button *ngIf="currentStep > 1" (click)="prevStep()" class="btn-secondary">
                        <i class="fas fa-arrow-left"></i>
                        Back
                    </button>

                    <button *ngIf="currentStep < totalSteps" (click)="nextStep()" class="btn-primary"
                        [disabled]="!isStepValid()">
                        Continue
                        <i class="fas fa-arrow-right"></i>
                    </button>

                    <button *ngIf="currentStep === totalSteps" (click)="processPayment()" class="btn-success"
                        [disabled]="!isStepValid() || isProcessing">
                        <i class="fas fa-lock" *ngIf="!isProcessing"></i>
                        <i class="fas fa-spinner fa-spin" *ngIf="isProcessing"></i>
                        <span *ngIf="!isProcessing">Complete Order</span>
                        <span *ngIf="isProcessing">Processing...</span>
                    </button>
                </div>
            </div>

            <!-- Order Summary -->
            <div class="order-summary">
                <div class="summary-card">
                    <h3 class="summary-title">Order Summary</h3>

                    <div class="order-items">
                        <div class="order-item" *ngFor="let item of checkoutItems">
                            <img [src]="item.image" [alt]="item.title">
                            <div class="item-info">
                                <h4>{{item.title}}</h4>
                                <span class="item-qty">Qty: {{item.quantity}}</span>
                            </div>
                            <div class="item-price">${{(item.price * item.quantity).toFixed(2)}}</div>
                        </div>
                    </div>

                    <div class="summary-divider"></div>

                    <div class="summary-line">
                        <span>Subtotal</span>
                        <span>${{subtotal.toFixed(2)}}</span>
                    </div>

                    <div class="summary-line">
                        <span>Shipping</span>
                        <span *ngIf="shipping === 0" class="free-shipping">FREE</span>
                        <span *ngIf="shipping > 0">${{shipping.toFixed(2)}}</span>
                    </div>

                    <div class="summary-line">
                        <span>Tax</span>
                        <span>${{tax.toFixed(2)}}</span>
                    </div>

                    <div class="summary-divider"></div>

                    <div class="summary-total">
                        <span>Total</span>
                        <span>${{total.toFixed(2)}}</span>
                    </div>

                    <div class="security-info">
                        <i class="fas fa-shield-alt"></i>
                        <span>Your payment information is secure and encrypted</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="checkout-footer">
            <a routerLink="/cart" class="back-to-cart">
                <i class="fas fa-arrow-left"></i>
                Return to Cart
            </a>

            <div class="help-text">
                Need help? <a href="mailto:support@astore.com">Contact Support</a>
            </div>
        </div>
    </div>
</div>